(()=>{"use strict";var t={368:(t,a,i)=>{i.d(a,{Z:()=>n});var e=i(645),s=i.n(e)()((function(t){return t[1]}));s.push([t.id,"input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}",""]);const n=s},619:(t,a,i)=>{i.d(a,{Z:()=>n});var e=i(645),s=i.n(e)()((function(t){return t[1]}));s.push([t.id,"input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}",""]);const n=s},645:t=>{t.exports=function(t){var a=[];return a.toString=function(){return this.map((function(a){var i=t(a);return a[2]?"@media ".concat(a[2]," {").concat(i,"}"):i})).join("")},a.i=function(t,i,e){"string"==typeof t&&(t=[[null,t,""]]);var s={};if(e)for(var n=0;n<this.length;n++){var r=this[n][0];null!=r&&(s[r]=!0)}for(var o=0;o<t.length;o++){var c=[].concat(t[o]);e&&s[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),a.push(c))}},a}},379:(t,a,i)=>{var e,s=function(){return void 0===e&&(e=Boolean(window&&document&&document.all&&!window.atob)),e},n=function(){var t={};return function(a){if(void 0===t[a]){var i=document.querySelector(a);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[a]=i}return t[a]}}(),r=[];function o(t){for(var a=-1,i=0;i<r.length;i++)if(r[i].identifier===t){a=i;break}return a}function c(t,a){for(var i={},e=[],s=0;s<t.length;s++){var n=t[s],c=a.base?n[0]+a.base:n[0],d=i[c]||0,l="".concat(c," ").concat(d);i[c]=d+1;var u=o(l),f={css:n[1],media:n[2],sourceMap:n[3]};-1!==u?(r[u].references++,r[u].updater(f)):r.push({identifier:l,updater:p(f,a),references:1}),e.push(l)}return e}function d(t){var a=document.createElement("style"),e=t.attributes||{};if(void 0===e.nonce){var s=i.nc;s&&(e.nonce=s)}if(Object.keys(e).forEach((function(t){a.setAttribute(t,e[t])})),"function"==typeof t.insert)t.insert(a);else{var r=n(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(a)}return a}var l,u=(l=[],function(t,a){return l[t]=a,l.filter(Boolean).join("\n")});function f(t,a,i,e){var s=i?"":e.media?"@media ".concat(e.media," {").concat(e.css,"}"):e.css;if(t.styleSheet)t.styleSheet.cssText=u(a,s);else{var n=document.createTextNode(s),r=t.childNodes;r[a]&&t.removeChild(r[a]),r.length?t.insertBefore(n,r[a]):t.appendChild(n)}}function v(t,a,i){var e=i.css,s=i.media,n=i.sourceMap;if(s?t.setAttribute("media",s):t.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(e+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}var _=null,h=0;function p(t,a){var i,e,s;if(a.singleton){var n=h++;i=_||(_=d(a)),e=f.bind(null,i,n,!1),s=f.bind(null,i,n,!0)}else i=d(a),e=v.bind(null,i,a),s=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else s()}}t.exports=function(t,a){(a=a||{}).singleton||"boolean"==typeof a.singleton||(a.singleton=s());var i=c(t=t||[],a);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var e=0;e<i.length;e++){var s=o(i[e]);r[s].references--}for(var n=c(t,a),d=0;d<i.length;d++){var l=o(i[d]);0===r[l].references&&(r[l].updater(),r.splice(l,1))}i=n}}}}},a={};function i(e){var s=a[e];if(void 0!==s)return s.exports;var n=a[e]={id:e,exports:{}};return t[e](n,n.exports,i),n.exports}i.n=t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return i.d(a,{a}),a},i.d=(t,a)=>{for(var e in a)i.o(a,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:a[e]})},i.o=(t,a)=>Object.prototype.hasOwnProperty.call(t,a),i.nc=void 0,(()=>{const t={props:{curso_id:"",retornable:{type:Boolean,default:!1}},data:function(){return{loading:!1,curso:{id:0,capacidades:[],matricula_unidades:[]},notas:{}}},mounted:function(){this.obtenerDatos(),this.$nextTick((function(){window.onbeforeunload=function(){}}))},methods:{obtenerDatos:function(){var t=this;this.loading=!0,this.$http.get("/cursos/"+this.curso_id+"/notas").then((function(a){var i=a.data;t.curso=i.curso,t.notas=i.notas,t.loading=!1,t.$nextTick((function(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(t){return new bootstrap.Tooltip(t)}))}))})).catch((function(a){Swal.fire({title:"Error",text:a.data.message||"No se pudo cargar",icon:"error"}),t.loading=!1}))},guardar:function(){for(var t in this.notas){var a=this.notas[t];if(a.valor<0||a.valor>20)return void alert("Revise los valores ingresados")}var i=this;i.loading=!0,Swal.fire({title:"¿Estás seguro que desea guardar estas notas?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, guardar",cancelButtonText:"Cancelar"}).then((function(t){t.isConfirmed&&i.$http.post("/cursos/"+i.curso.id+"/notas",i.notas).then((function(t){t.data;i.loading=!1,i.obtenerDatos(),Swal.fire({title:"Completado",text:"Notas guardadas",icon:"success"}).catch((function(t){i.loading=!1,Swal.fire({title:"Error",text:t.data.message||"No se pudo guardar",icon:"error"})}))})),i.loading=!1}))},mensajear:function(t){t.esta_inhabilitado&&Swal.fire({title:"Alerta",text:"El alumno está inhabilitado por la acumulación del 30% de inasistencias, conforme al reglamento interno de la institución",icon:"warning"})},calcularPromedio:function(t,a){var i=0,e=0;for(var s in t.indicadores){var n=this.notas[a+"-"+t.indicadores[s].id];i+=parseFloat(n.valor||0),e+=1}return t.valor=i/e,t.valor.toFixed(0)},calcularPromedioFinal:function(t){var a=0,i=0;for(var e in this.curso.capacidades){var s=this.curso.capacidades[e];a+=this.calcularPromedio(s,t)*parseFloat(s.peso),i+=parseFloat(s.peso)}return(a/i).toFixed(0)}},watch:{curso_id:function(){this.obtenerDatos()}}};var a=i(379),e=i.n(a),s=i(619),n={insert:"head",singleton:!1};e()(s.Z,n);s.Z.locals;function r(t,a,i,e,s,n,r,o){var c,d="function"==typeof t?t.options:t;if(a&&(d.render=a,d.staticRenderFns=i,d._compiled=!0),e&&(d.functional=!0),n&&(d._scopeId="data-v-"+n),r?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=c):s&&(c=o?function(){s.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(t,a){return c.call(a),l(t,a)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:d}}const o=r(t,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"card border-0"},[t.curso.matricula_unidades.length>0?a("div",{staticClass:"card-body"},[a("div",{staticClass:"d-flex justify-content-between"},[t.retornable?a("a",{staticClass:"btn btn-outline-primary",attrs:{href:"/cursos/notas"}},[a("i",{staticClass:"fa fa-arrow-left mr-2"}),t._v("Lista de unidades")]):t._e(),t._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{disabled:t.loading},on:{click:t.guardar}},[a("i",{staticClass:"fa fa-save mr-2"}),t._v("Guardar")])])]):t._e(),t._v(" "),t.curso.matricula_unidades.length>0?a("div",{staticClass:"card-body p-0 border-0 table-responsive"},[a("table",{staticClass:"table table-sm table-bordered"},[a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("Código")]),t._v(" "),a("th",{attrs:{rowspan:"2"}},[t._v("Alumno")]),t._v(" "),t._l(t.curso.capacidades,(function(i){return a("th",{staticClass:"text-center",attrs:{colspan:i.indicadores.length+1}},[t._v("\n                        "+t._s(i.nombre)+" "),a("br"),t._v("\n                        ("+t._s(i.porcentaje)+"%)\n                    ")])})),t._v(" "),a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("Promedio")])],2),t._v(" "),a("tr",[t._l(t.curso.capacidades,(function(i){return[t._l(i.indicadores,(function(i){return a("th",{staticClass:"text-center",staticStyle:{"min-width":"50px !important"},attrs:{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:i.nombre}},[t._v("\n                            "+t._s(i.codigo)+"\n                        ")])})),t._v(" "),a("th",{staticClass:"text-right",attrs:{"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Promedio"}},[t._v("Prom.")])]}))],2)]),t._v(" "),a("tbody",t._l(t.curso.matricula_unidades,(function(i){var e,s,n,r;return a("tr",[a("td",{staticClass:"text-center"},[t._v(t._s(null===(e=i.matricula)||void 0===e?void 0:e.codigo))]),t._v(" "),a("td",{staticClass:"text-nowrap"},[t._v(t._s(null===(s=i.matricula)||void 0===s||null===(n=s.estudiante)||void 0===n||null===(r=n.persona)||void 0===r?void 0:r.nombre_completo))]),t._v(" "),t._l(t.curso.capacidades,(function(e){return[t._l(e.indicadores,(function(e){return a("td",{staticClass:"text-center pr-0"},[a("input",{directives:[{name:"model",rawName:"v-model.lazy.number",value:t.notas[i.id+"-"+e.id].valor,expression:"notas[mu.id + '-' + indicador.id].valor",modifiers:{lazy:!0,number:!0}}],staticClass:"form-control",class:{"border-danger":t.notas[i.id+"-"+e.id].valor<0||t.notas[i.id+"-"+e.id].valor>20,"border-0":t.notas[i.id+"-"+e.id].valor>=0&&t.notas[i.id+"-"+e.id].valor<=20},attrs:{type:"number",step:"0.01",disabled:t.loading,readonly:i.esta_inhabilitado},domProps:{value:t.notas[i.id+"-"+e.id].valor},on:{click:function(a){return t.mensajear(i)},change:function(a){t.$set(t.notas[i.id+"-"+e.id],"valor",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})])})),t._v(" "),a("th",{staticClass:"text-right"},[t._v("\n                            "+t._s(t.calcularPromedio(e,i.id))+"\n                        ")])]})),t._v(" "),i.esta_inhabilitado?a("th",{staticClass:"text-center"},[a("div",{staticClass:"badge bg-danger"},[t._v("Inhabilitado (30%)")])]):a("th",{staticClass:"text-right"},[t._v("\n                        "+t._s(t.calcularPromedioFinal(i.id))+"\n                    ")])],2)})),0)])]):a("div",{staticClass:"card-body"},[a("div",{staticClass:"alert alert-danger"},[t._v("No hay alumnos matriculados")])])])}),[],!1,null,null,null).exports;const c={props:{curso_id:"",retornable:{type:Boolean,default:!1}},data:function(){return{loading:!1,extendido:!1,curso:{id:0,capacidades:[],matricula_unidades:[]},asistencias:{},horarios_semanales:{}}},mounted:function(){this.obtenerDatos(),this.$nextTick((function(){window.onbeforeunload=function(){}}))},methods:{obtenerDatos:function(){var t=this;this.loading=!0,this.$http.get("/cursos/"+this.curso_id+"/asistencia").then((function(a){var i=a.data;t.curso=i.curso,t.asistencias=i.asistencias,t.horarios_semanales=i.horarios_semanales,t.loading=!1,t.$nextTick((function(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(t){return new bootstrap.Tooltip(t)}))}))})).catch((function(a){Swal.fire({title:"Error",text:a.data.message||"No se pudo cargar",icon:"error"}),t.loading=!1}))},registrarAsistencia:function(t){this.asistencias[t].asistio=!this.asistencias[t].asistio},resetearAsistencia:function(t){this.asistencias[t].asistio=!0,this.asistencias[t].es_tardanza=!1,this.asistencias[t].es_permiso=!1},registrarTardanza:function(t){this.asistencias[t].asistio=!1,this.asistencias[t].es_tardanza=!0,this.asistencias[t].es_permiso=!1},registrarPermiso:function(t){this.asistencias[t].asistio=!1,this.asistencias[t].es_tardanza=!1,this.asistencias[t].es_permiso=!0},verificar:function(){var t=this;this.existe_alguno_a_inhabilitarse?Swal.fire({text:"Guardar esta asistencia inhabilitará a uno o más alumnos. Seleccione continuar si estos datos son correctos y desea guardar de todas maneras.",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, continuar",cancelButtonText:"Cancelar"}).then((function(a){a.isConfirmed&&t.guardar(),t.loading=!1})):t.guardar()},guardar:function(){var t=this;t.loading=!0,Swal.fire({title:"¿Estás seguro que desea guardar estas asistencias?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, guardar",cancelButtonText:"Cancelar"}).then((function(a){a.isConfirmed&&t.$http.post("/cursos/"+t.curso.id+"/asistencia",{asistencias:t.asistencias,matriculas:t.procesarAsistencias()}).then((function(a){a.data;t.loading=!1,t.obtenerDatos(),Swal.fire({title:"Completado",text:"Asistencias guardadas",icon:"success"}).catch((function(a){t.loading=!1,Swal.fire({title:"Error",text:a.data.message||"No se pudo guardar",icon:"error"})}))})),t.loading=!1}))},calcularPromedioFinal:function(t){var a=0,i=0;for(var e in this.horarios_semanales){var s=this.horarios_semanales[e];for(var n in s.horarios){var r=s.horarios[n],o=this.asistencias[t+"-"+r.codigo];a+=o.asistio||o.es_tardanza||o.es_permiso?0:1,i++}}return 100*a/i},formatea:function(t){return t.toFixed(2)},procesarAsistencias:function(){var t=this.curso.matricula_unidades;for(var a in t){var i=t[a];i.esta_inhabilitado=!1,this.calcularPromedioFinal(i.id)>=30&&(i.esta_inhabilitado=!0)}return t}},computed:{existe_alguno_a_inhabilitarse:function(){var t=!1;for(var a in this.curso.matricula_unidades){var i=this.curso.matricula_unidades[a];this.calcularPromedioFinal(i.id)>=30&&(t=!0)}return t}},watch:{curso_id:function(){this.obtenerDatos()}}};var d=i(368),l={insert:"head",singleton:!1};e()(d.Z,l);d.Z.locals;const u=r(c,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"card border-0"},[t.curso.matricula_unidades.length>0?a("div",{staticClass:"card-body"},[a("div",{staticClass:"d-flex justify-content-between"},[t.retornable?a("a",{staticClass:"btn btn-outline-primary",attrs:{href:"/cursos/notas"}},[a("i",{staticClass:"fa fa-arrow-left mr-2"}),t._v("Lista de unidades")]):t._e(),t._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{disabled:t.loading},on:{click:t.verificar}},[a("i",{staticClass:"fa fa-save mr-2"}),t._v("Guardar")])]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"custom-control custom-switch"},[a("br"),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.extendido,expression:"extendido"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"customSwitch2"},domProps:{checked:Array.isArray(t.extendido)?t._i(t.extendido,null)>-1:t.extendido},on:{change:function(a){var i=t.extendido,e=a.target,s=!!e.checked;if(Array.isArray(i)){var n=t._i(i,null);e.checked?n<0&&(t.extendido=i.concat([null])):n>-1&&(t.extendido=i.slice(0,n).concat(i.slice(n+1)))}else t.extendido=s}}}),t._v(" "),a("label",{staticClass:"custom-control-label",attrs:{for:"customSwitch2"}},[t._v("Todas las opciones")])])])])])]):t._e(),t._v(" "),t.curso.matricula_unidades.length>0?a("div",{staticClass:"card-body p-0 border-0 table-responsive"},[a("table",{staticClass:"table table-sm table-bordered"},[a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("Código")]),t._v(" "),a("th",{attrs:{rowspan:"2"}},[t._v("Alumno")]),t._v(" "),t._l(t.horarios_semanales,(function(i){return a("th",{staticClass:"text-center",attrs:{colspan:i.horarios.length}},[t._v("\n                        Semana "+t._s(i.semana)+" "),a("br"),t._v("\n                        "+t._s(i.inicio)+" - "+t._s(i.fin)+"\n                    ")])})),t._v(" "),a("th",{attrs:{rowspan:"2"}},[t._v("%")])],2),t._v(" "),a("tr",[t._l(t.horarios_semanales,(function(i){return t._l(i.horarios,(function(i){return a("td",{staticClass:"text-center text-nowrap"},[a("b",[t._v("\n                                "+t._s(i.dia)+" "),a("br"),t._v("\n                                "+t._s(i.fecha_formateada)+" "),a("br")]),t._v(" "),a("small",[t._v(" "+t._s(i.inicio)+" - "+t._s(i.fin))])])}))}))],2)]),t._v(" "),a("tbody",t._l(t.curso.matricula_unidades,(function(i){var e,s,n,r;return a("tr",[a("td",{staticClass:"text-center"},[t._v(t._s(null===(e=i.matricula)||void 0===e?void 0:e.codigo))]),t._v(" "),a("td",{staticClass:"text-nowrap"},[t._v(t._s(null===(s=i.matricula)||void 0===s||null===(n=s.estudiante)||void 0===n||null===(r=n.persona)||void 0===r?void 0:r.nombre_completo))]),t._v(" "),t._l(t.horarios_semanales,(function(e){return t._l(e.horarios,(function(e){return a("td",{staticClass:"text-center text-nowrap"},[t.asistencias[i.id+"-"+e.codigo].es_tardanza||t.asistencias[i.id+"-"+e.codigo].es_permiso?t._e():a("div",{staticClass:"btn-group"},[t.asistencias[i.id+"-"+e.codigo].asistio?a("button",{staticClass:"btn btn-primary",attrs:{disabled:i.esta_inhabilitado},on:{click:function(a){return t.registrarAsistencia(i.id+"-"+e.codigo)}}},[t._v("\n                                    A\n                                ")]):t._e(),t._v(" "),t.asistencias[i.id+"-"+e.codigo].asistio?t._e():a("button",{staticClass:"btn btn-outline-danger",attrs:{disabled:i.esta_inhabilitado},on:{click:function(a){return t.registrarAsistencia(i.id+"-"+e.codigo)}}},[t._v("\n                                    F\n                                ")]),t._v(" "),t.extendido?a("button",{staticClass:"btn dropdown-toggle dropdown-icon px-1",class:{"btn-outline-danger":!t.asistencias[i.id+"-"+e.codigo].asistio,"btn-primary":t.asistencias[i.id+"-"+e.codigo].asistio},attrs:{disabled:i.esta_inhabilitado,type:"button","data-toggle":"dropdown"}},[a("span",{staticClass:"sr-only"},[t._v("Toggle")])]):t._e(),t._v(" "),a("div",{staticClass:"dropdown-menu",attrs:{role:"menu",disabled:i.esta_inhabilitado}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return t.registrarTardanza(i.id+"-"+e.codigo)}}},[t._v("Tardanza")]),t._v(" "),a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){return t.registrarPermiso(i.id+"-"+e.codigo)}}},[t._v("Permiso")])])]),t._v(" "),t.asistencias[i.id+"-"+e.codigo].es_tardanza?a("button",{staticClass:"btn btn-warning",attrs:{disabled:i.esta_inhabilitado},on:{click:function(a){return t.resetearAsistencia(i.id+"-"+e.codigo)}}},[t._v("\n                                T\n                            ")]):t._e(),t._v(" "),t.asistencias[i.id+"-"+e.codigo].es_permiso?a("button",{staticClass:"btn btn-success",attrs:{disabled:i.esta_inhabilitado},on:{click:function(a){return t.resetearAsistencia(i.id+"-"+e.codigo)}}},[t._v("\n                                P\n                            ")]):t._e()])}))})),t._v(" "),a("td",{class:{"text-danger":i.esta_inhabilitado}},[t._v(t._s(t.formatea(t.calcularPromedioFinal(i.id)))+"%")])],2)})),0)])]):a("div",{staticClass:"card-body"},[a("div",{staticClass:"alert alert-danger"},[t._v("No hay alumnos matriculados")])])])}),[],!1,null,null,null).exports;new Vue({el:"#app",data:{filtros:{id_rubro_turno:"",id_programa:"",id_periodo:"",id_unidad:"",id_curso:""},programas:[],rubros:[],unidades:[],cursos:[]},created:function(){this.obtenerDatos()},methods:{obtenerDatos:function(){this.$http.get("/cursos/notas/programas").then((function(t){this.programas=t.data.programas,this.rubros=t.data.rubros_turnos,this.filtros.id_programa=t.data.id_programa,this.filtros.id_rubro_turno=t.data.id_rubro_turno}))},obtenerUnidades:function(){this.$http.get("/cursos/notas/"+this.filtros.id_programa+"/unidades").then((function(t){this.unidades=t.data.unidades,this.filtros.id_unidad=t.data.id_unidad}))},obtenerCursos:function(){this.$http.get("/cursos/notas/"+this.filtros.id_unidad+"/cursos",{params:this.filtros}).then((function(t){this.cursos=t.data.cursos,this.filtros.id_curso=t.data.id_curso}))}},components:{UsakoNotas:o,UsakoAsistencia:u},watch:{"filtros.id_programa":function(){this.obtenerUnidades()},"filtros.id_unidad":function(){this.obtenerCursos()}}})})()})();